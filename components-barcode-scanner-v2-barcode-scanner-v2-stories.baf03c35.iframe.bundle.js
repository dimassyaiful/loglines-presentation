/*! For license information please see components-barcode-scanner-v2-barcode-scanner-v2-stories.baf03c35.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkloglines_component=self.webpackChunkloglines_component||[]).push([[1645],{"./node_modules/react/cjs/react-jsx-runtime.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{var f=__webpack_require__("./node_modules/react/index.js"),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},"./node_modules/react/jsx-runtime.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/react/cjs/react-jsx-runtime.production.min.js")},"./src/components/barcode-scanner-v2/barcode-scanner-v2.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>barcode_scanner_v2_stories});var __assign=function(){return __assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function tslib_es6_awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}function tslib_es6_generator(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return g.next=verb(0),g.throw=verb(1),g.return=verb(2),"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}Object.create;function __spreadArray(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))}Object.create;"function"==typeof SuppressedError&&SuppressedError;var react=__webpack_require__("./node_modules/react/index.js"),eventListener=function(target_1,event_1){for(var args_1=[],_i=2;_i<arguments.length;_i++)args_1[_i-2]=arguments[_i];return tslib_es6_awaiter(void 0,__spreadArray([target_1,event_1],args_1,!0),void 0,function(target,event,errorEvent){var $resolve,$reject;return void 0===errorEvent&&(errorEvent="error"),tslib_es6_generator(this,function(_a){switch(_a.label){case 0:return[4,new Promise(function(resolve,reject){$resolve=resolve,$reject=reject,target.addEventListener(event,$resolve),target.addEventListener(errorEvent,$reject)}).finally(function(){target.removeEventListener(event,$resolve),target.removeEventListener(errorEvent,$reject)})];case 1:return[2,_a.sent()]}})})};function createAtom(){var subscriptions=[];return{set:function set(newValue){setTimeout(function(){subscriptions.forEach(function(c){c(newValue)})})},subscriptions}}var streamAtom=createAtom();function use_stream_state_useStreamState(){var _a=function use_atom_useAtom(atom,initialState){var _a=(0,react.useState)(initialState),state=_a[0],setState=_a[1];return(0,react.useEffect)(function(){var index=atom.subscriptions.push(setState);return function(){atom.subscriptions.splice(index,1)}},[atom]),[state,atom.set]}(streamAtom);return[_a[0],_a[1]]}var DEFAULT_CONSTRAINTS={width:{min:640,ideal:1280},height:{min:480,ideal:720},facingMode:{ideal:"environment"},advanced:[{width:1920,height:1280},{aspectRatio:1.333}]};var DEFAULT_OPTIONS={delay:1e3,formats:["qr_code"]};createAtom();var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const barcode_scanner=function(_a){var options=_a.options,onCapture=_a.onCapture,trackConstraints=_a.trackConstraints,_b=_a.paused,paused=void 0!==_b&&_b,props=__rest(_a,["options","onCapture","trackConstraints","paused"]),instance=(0,react.useRef)(null),isCameraSupport=function useCamera(ref,trackConstraints){var _this=this,_a=(0,react.useState)(!1),isCameraSupported=_a[0],setCameraSupported=_a[1],setStream=use_stream_state_useStreamState()[1];(0,react.useEffect)(function(){if(!window.isSecureContext)throw new Error("[react-barcode-scanner]: \n        Browser ask for secure origin (such as https) when use getUserMedia,\n        reference: https://sites.google.com/a/chromium.org/dev/Home/chromium-security/deprecating-powerful-features-on-insecure-origins\n      ")},[]);var constraints=(0,react.useMemo)(function(){return{audio:!1,video:Object.assign({},DEFAULT_CONSTRAINTS,trackConstraints)}},[trackConstraints]);return(0,react.useEffect)(function(){var stream,cancelled=!1,close=function(){null==stream||stream.getTracks().forEach(function(track){track.stop()})};return tslib_es6_awaiter(_this,void 0,void 0,function(){var target;return tslib_es6_generator(this,function(_a){switch(_a.label){case 0:return null==(target=ref.current)?[2]:[4,navigator.mediaDevices.getUserMedia(constraints)];case 1:return stream=_a.sent(),void 0!==target.mozSrcObject?target.mozSrcObject=stream:target.srcObject=stream,[4,eventListener(target,"loadeddata")];case 2:return _a.sent(),[4,(milliseconds=500,tslib_es6_awaiter(void 0,void 0,void 0,function(){return tslib_es6_generator(this,function(_a){switch(_a.label){case 0:return[4,new Promise(function(resolve){return setTimeout(resolve,milliseconds)})];case 1:return _a.sent(),[2]}})}))];case 3:return _a.sent(),setCameraSupported(!0),setStream(stream),[2]}var milliseconds})}).then(function(){cancelled&&close()}),function(){cancelled=!0,close()}},[ref,constraints,setStream]),[isCameraSupported]}(instance,trackConstraints)[0],_c=function useScanning(ref,provideOptions){var _this=this,_a=(0,react.useState)(),detectedBarcodes=_a[0],setDetectBarcodes=_a[1],_b=(0,react.useState)(!1),start=_b[0],setStart=_b[1],options=(0,react.useMemo)(function(){return Object.assign({},DEFAULT_OPTIONS,provideOptions)},[provideOptions]),scan=(0,react.useCallback)(function(){return tslib_es6_awaiter(_this,void 0,void 0,function(){var target,detected;return tslib_es6_generator(this,function(_a){switch(_a.label){case 0:return target=ref.current,[4,new BarcodeDetector({formats:options.formats}).detect(target)];case 1:return void 0!==(detected=_a.sent())&&detected.length>0&&setDetectBarcodes(detected),[2]}})})},[ref,options.formats]);return(0,react.useEffect)(function(){if(null!=ref.current&&start){var timer,cancelled=!1,frame=function(){return tslib_es6_awaiter(_this,void 0,void 0,function(){return tslib_es6_generator(this,function(_a){switch(_a.label){case 0:return[4,scan()];case 1:return _a.sent(),cancelled||(timer=window.setTimeout(frame,options.delay)),[2]}})})};return frame(),function(){clearTimeout(timer),cancelled=!0}}},[start,ref,options.delay,scan]),(0,react.useEffect)(function(){0===options.formats.length&&setStart(!1)},[options.formats]),[detectedBarcodes,(0,react.useCallback)(function(){setStart(!0)},[]),(0,react.useCallback)(function(){setStart(!1)},[])]}(instance,options),detected=_c[0],open=_c[1],close=_c[2];return(0,react.useEffect)(function(){isCameraSupport&&!paused?open():close()},[close,isCameraSupport,open,paused]),(0,react.useEffect)(function(){void 0!==detected&&(null==onCapture||onCapture(detected))},[detected,onCapture]),(0,react.useEffect)(function(){var video=instance.current;video&&(isCameraSupport&&!paused?video.play().catch(console.error):video.pause())},[paused,isCameraSupport]),(0,jsx_runtime.jsx)("video",__assign({ref:instance,style:{width:"100%",height:"100%",objectFit:"cover"},autoPlay:!0,muted:!0,playsInline:!0},props))};var BarcodeFormat;!function(BarcodeFormat){BarcodeFormat.CODE_128="code_128",BarcodeFormat.CODE_39="code_39",BarcodeFormat.CODE_93="code_93",BarcodeFormat.CODABAR="codabar",BarcodeFormat.EAN_13="ean_13",BarcodeFormat.EAN_8="ean_8",BarcodeFormat.ITF="itf",BarcodeFormat.QR_CODE="qr_code",BarcodeFormat.UPC_A="upc_a",BarcodeFormat.UPC_E="upc_e"}(BarcodeFormat||(BarcodeFormat={}));const sound_barcode_scanner_namespaceObject=__webpack_require__.p+"107eae52b798a8b44e57.mp3",BarcodeScannerV2=_ref=>{let{onCapture,type,isStop}=_ref;const audioRef=(0,react.useRef)(new Audio(sound_barcode_scanner_namespaceObject)),[isScannerActive,setIsScannerActive]=(0,react.useState)(!0);return(0,react.useEffect)(()=>{setIsScannerActive(!isStop)},[isStop]),(0,react.useEffect)(()=>()=>{setIsScannerActive(!1)},[]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:isScannerActive&&(0,jsx_runtime.jsx)(barcode_scanner,{options:{formats:[...type],delay:500},onCapture:data=>{isStop||data.length>0&&(audioRef.current.currentTime=0,audioRef.current.play().catch(error=>console.error("Audio play failed",error)),onCapture(data[0]))}})})},barcode_scanner_v2_component=BarcodeScannerV2;BarcodeScannerV2.__docgenInfo={description:"",methods:[],displayName:"BarcodeScannerV2",props:{onCapture:{required:!0,tsType:{name:"signature",type:"function",raw:"(detectedBarcode: DetectedBarcode) => void",signature:{arguments:[{type:{name:"DetectedBarcode"},name:"detectedBarcode"}],return:{name:"void"}}},description:""},type:{required:!0,tsType:{name:"Array",elements:[{name:"union",raw:"| 'code_128'\n| 'code_39'\n| 'code_93'\n| 'ean_13'\n| 'qr_code'\n| 'codabar'\n| 'data_matrix'\n| 'ean_8'\n| 'upc_a'\n| 'upc_e'",elements:[{name:"literal",value:"'code_128'"},{name:"literal",value:"'code_39'"},{name:"literal",value:"'code_93'"},{name:"literal",value:"'ean_13'"},{name:"literal",value:"'qr_code'"},{name:"literal",value:"'codabar'"},{name:"literal",value:"'data_matrix'"},{name:"literal",value:"'ean_8'"},{name:"literal",value:"'upc_a'"},{name:"literal",value:"'upc_e'"}]}],raw:"FormatBarcodeScannerV2[]"},description:""},isStop:{required:!1,tsType:{name:"boolean"},description:""}}};var dist=__webpack_require__("./node_modules/@storybook/test/dist/index.mjs");const barcode_scanner_v2_stories={title:"Components/BarcodeScannerV2",component:barcode_scanner_v2_component,tags:["autodocs"],argTypes:{isStop:{control:"boolean"},type:{control:"multi-select",options:["code_128","code_39","code_93","ean_13","qr_code","codabar","data_matrix","ean_8","upc_a","upc_e"]}}},Default={args:{isStop:!1,type:["qr_code","ean_13"],onCapture:()=>(0,dist.fn)()}},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: {\n    isStop: false,\n    type: ['qr_code', 'ean_13'],\n    onCapture: () => fn()\n  }\n}",...Default.parameters?.docs?.source}}}}}]);